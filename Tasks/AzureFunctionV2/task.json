{
  "id": "537FDB7A-A601-4537-AA70-92645A2B5CE4",
  "name": "AzureFunction",
  "friendlyName": "Invoke Azure Function",
  "description": "Invoke an Azure Function",
  "helpUrl": "https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/azure-function",
  "helpMarkDown": "[Learn more about this task](https://go.microsoft.com/fwlink/?linkid=870235)",
  "category": "Utility",
  "visibility": [
    "Build",
    "Release"
  ],
  "runsOn": [
    "Server",
    "ServerGate",
    "Agent",
    "DeploymentGroup"
  ],
  "author": "Microsoft Corporation",
  "version": {
    "Major": 2,
    "Minor": 250,
    "Patch": 0
  },
  "releaseNotes": "What's new in version 2.* <br /> Added",
  "groups": [
    {
      "name": "completionOptions",
      "displayName": "Advanced",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
        "name": "authenticationOptionSelector",
        "aliases": [
            "authenticationType"
        ],
        "type": "pickList",
        "label": "Authentication option",
        "required": true,
        "helpMarkDown": "Select the service connection type to use to invoke the REST API.",
        "defaultValue": "keyAuthentication",
        "options": {
            "keyAuthentication": "Function Key",
            "ARMAuthentication": "Azure Resource Manager"
        }
    },
    {
        "name": "ARMAuthentication",
        "aliases": [
            "azureServiceConnection",
            "azureSubscription"
        ],
        "type": "connectedService:AzureRM",
        "label": "Azure subscription",
        "required": true,
        "helpMarkDown": "Select an Azure Resource Manager subscription to use for invoking a management API. 'ManagementPortalUrl' of the cloud is used as the baseURL",
        "visibleRule": "authenticationOptionSelector = ARMAuthentication"
    },
    {
      "name": "function",
      "type": "string",
      "label": "Azure function URL",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "URL of the Azure function that needs to be invoked​. Example:- https://azurefunctionapp.azurewebsites.net/api/HttpTriggerJS1"
    },
    {
      "name": "key",
      "type": "string",
      "label": "Function key",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Function or Host key with which to access this function. To keep the key secure, define a secret variable and use it here. Example: - $(myFunctionKey) where myFunctionKey is a secret pipeline variable with a value of the secret key, like `ZxPXnIEODXLRzYwCw1TgZ4osMfoKs9Zn6se6X/N0FnztfDvZbdOmYw==`"
    },
    {
      "name": "method",
      "type": "pickList",
      "label": "Method",
      "required": true,
      "defaultValue": "POST",
      "options": {
        "OPTIONS": "OPTIONS",
        "GET": "GET",
        "HEAD": "HEAD",
        "POST": "POST",
        "PUT": "PUT",
        "DELETE": "DELETE",
        "TRACE": "TRACE",
        "PATCH": "PATCH"
      },
      "helpMarkDown": "Select the HTTP method with which the function should be invoked."
    },
    {
      "name": "headers",
      "type": "multiLine",
      "label": "Headers",
      "required": false,
      "defaultValue": "{\n\"Content-Type\":\"application/json\", \n\"PlanUrl\": \"$(system.CollectionUri)\", \n\"ProjectId\": \"$(system.TeamProjectId)\", \n\"HubName\": \"$(system.HostType)\", \n\"PlanId\": \"$(system.PlanId)\", \n\"JobId\": \"$(system.JobId)\", \n\"TimelineId\": \"$(system.TimelineId)\", \n\"TaskInstanceId\": \"$(system.TaskInstanceId)\", \n\"AuthToken\": \"$(system.AccessToken)\"\n}",
      "properties": {
        "resizable": true,
        "rows": "10",
        "maxLength": "5000"
      },
      "helpMarkDown": "Define a header in JSON format. The header shall be attached to the request that is sent."
    },
    {
      "name": "queryParameters",
      "type": "string",
      "label": "Query parameters",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Query parameters string to append to the function URL. It should not start with with \"?\" nor \"&\"."
    },
    {
      "name": "body",
      "type": "multiLine",
      "label": "Body",
      "required": false,
      "defaultValue": "",
      "properties": {
        "resizable": true,
        "rows": "3",
        "maxLength": "2000"
      },
      "visibleRule": "method != GET && method != HEAD",
      "helpMarkDown": "JSON-formatted message body for the request."
    },
    {
      "name": "waitForCompletion",
      "type": "pickList",
      "label": "Completion event",
      "defaultValue": "false",
      "required": true,
      "helpMarkDown": "Default value \"ApiResponse\". Available values: \"ApiResponse\", \"Callback\" call where the Azure function calls back to update the timeline record​.",
      "groupName": "completionOptions",
      "options": {
        "true": "Callback",
        "false": "ApiResponse"
      }
    },
    {
      "name": "successCriteria",
      "type": "string",
      "label": "Success criteria",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Criteria which defines when to pass the task. No criteria means the response content does not influence the result. Example:- For response {\"status\" : \"successful\"}, the expression can be eq(root['status'], 'successful'). [More information](https://go.microsoft.com/fwlink/?linkid=842996)​",
      "groupName": "completionOptions",
      "visibleRule": "waitForCompletion = false"
    }
  ],
  "instanceNameFormat": "Azure Function: $(function)",
  "execution": {
    "Node16": {
      "target": "azurermwebappdeployment.js",
      "argumentFormat": ""
    },
    "Node10": {
      "target": "azurermwebappdeployment.js"
    },
    "Node20_1": {
      "target": "azurermwebappdeployment.js",
      "argumentFormat": ""
    }
  },
  "messages": {
    "Invalidwebapppackageorfolderpathprovided": "Invalid App Service package or folder path provided: %s",
    "SetParamFilenotfound0": "Set parameters file not found: %s",
    "XDTTransformationsappliedsuccessfully": "XML Transformations applied successfully",
    "GotconnectiondetailsforazureRMWebApp0": "Got service connection details for Azure App Service:'%s'",
    "ErrorNoSuchDeployingMethodExists": "Error : No such deploying method exists",
    "UnabletoretrieveconnectiondetailsforazureRMWebApp": "Unable to retrieve service connection details for Azure App Service : %s. Status Code: %s (%s)",
    "UnabletoretrieveResourceID": "Unable to retrieve service connection details for Azure Resource:'%s'. Status Code: %s",
    "Successfullyupdateddeploymenthistory": "Successfully updated deployment History at %s",
    "Failedtoupdatedeploymenthistory": "Failed to update deployment history. Error: %s",
    "WARNINGCannotupdatedeploymentstatusSCMendpointisnotenabledforthiswebsite": "WARNING : Cannot update deployment status : SCM endpoint is not enabled for this website",
    "Unabletoretrievewebconfigdetails": "Unable to retrieve App Service configuration details. Status Code: '%s'",
    "Unabletoretrievewebappsettings": "Unable to retrieve App Service application settings. [Status Code: '%s', Error Message: '%s']",
    "Unabletoupdatewebappsettings": "Unable to update App service application settings. Status Code: '%s'",
    "CannotupdatedeploymentstatusuniquedeploymentIdCannotBeRetrieved": "Cannot update deployment status : Unique Deployment ID cannot be retrieved",
    "PackageDeploymentSuccess": "The web package has been deployed to App Service. Please note that the package mount or extraction errors will be logged in the deployment logs in the location above.",
    "PackageDeploymentFailed": "Failed to deploy web package to App Service.",
    "Runningcommand": "Running command: %s",
    "Deployingwebapplicationatvirtualpathandphysicalpath": "Deploying web package : %s at virtual path (physical path) : %s (%s)",
    "Successfullydeployedpackageusingkuduserviceat": "Successfully deployed package %s using kudu service at %s",
    "Failedtodeploywebapppackageusingkuduservice": "Failed to deploy App Service package using kudu service : %s",
    "Unabletodeploywebappresponsecode": "Unable to deploy App Service due to error code : %s",
    "MSDeploygeneratedpackageareonlysupportedforWindowsplatform": "MSDeploy generated packages are only supported for Windows platform.",
    "UnsupportedinstalledversionfoundforMSDeployversionshouldbeatleast3orabove": "Unsupported installed version: %s found for MSDeploy. version should be at least 3 or above",
    "UnabletofindthelocationofMSDeployfromregistryonmachineError": "Unable to find the location of MS Deploy from registry on machine (Error : %s)",
    "Nopackagefoundwithspecifiedpattern": "No package found with specified pattern: %s<br/>Check if the package mentioned in the task is published as an artifact in the build or a previous stage and downloaded in the current job.",
    "MorethanonepackagematchedwithspecifiedpatternPleaserestrainthesearchpattern": "More than one package matched with specified pattern: %s. Please restrain the search pattern.",
    "Trytodeploywebappagainwithappofflineoptionselected": "Try to deploy app service again with Take application offline option selected.",
    "Trytodeploywebappagainwithrenamefileoptionselected": "Try to deploy app service again with Rename locked files option selected.",
    "NOJSONfilematchedwithspecificpattern": "NO JSON file matched with specific pattern: %s.",
    "Configfiledoesntexists": "Configuration file %s doesn't exist.",
    "Failedtowritetoconfigfilewitherror": "Failed to write to config file %s with error : %s",
    "AppOfflineModeenabled": "App offline mode enabled.",
    "Failedtoenableappofflinemode": "Failed to enable app offline mode. Status Code: %s (%s)",
    "AppOflineModedisabled": "App offline mode disabled.",
    "FailedtodisableAppOfflineMode": "Failed to disable App offline mode. Status Code: %s (%s)",
    "CannotPerformXdtTransformationOnNonWindowsPlatform": "Cannot perform XML transformations on a non-Windows platform.",
    "XdtTransformationErrorWhileTransforming": "XML transformation error while transforming %s using %s.",
    "PublishusingwebdeployoptionsaresupportedonlywhenusingWindowsagent": "Publish using webdeploy options are supported only when using Windows agent",
    "Publishusingzipdeploynotsupportedformsbuildpackage": "Publish using zip deploy option is not supported for msBuild package type.",
    "Publishusingzipdeploynotsupportedforvirtualapplication": "Publish using zip deploy option is not supported for virtual application.",
    "Publishusingzipdeploydoesnotsupportwarfile": "Publish using zip deploy or RunFromPackage options do not support war file deployment.",
    "Publishusingrunfromzipwithpostdeploymentscript": "Publish using RunFromPackage might not support post deployment script if it makes changes to wwwroot, since the folder is ReadOnly.",
    "ResourceDoesntExist": "Resource '%s' doesn't exist. Resource should exist before deployment.",
    "EncodeNotSupported": "Detected file encoding of the file %s as %s. Variable substitution is not supported with file encoding %s. Supported encodings are UTF-8 and UTF-16 LE.",
    "UnknownFileEncodeError": "Unable to detect encoding of the file %s (typeCode: %s). Supported encodings are UTF-8 and UTF-16 LE.",
    "ShortFileBufferError": "File buffer is too short to detect encoding type : %s",
    "FailedToUpdateAzureRMWebAppConfigDetails": "Failed to update App Service configuration details. Error: %s",
    "SuccessfullyUpdatedAzureRMWebAppConfigDetails": "Successfully updated App Service configuration details",
    "RequestedURLforkuduphysicalpath": "Requested URL for kudu physical path : %s",
    "Physicalpathalreadyexists": "Physical path '%s' already exists",
    "KuduPhysicalpathCreatedSuccessfully": "Kudu physical path created successfully : %s",
    "FailedtocreateKuduPhysicalPath": "Failed to create kudu physical path. Error : %s",
    "FailedtocheckphysicalPath": "Failed to check kudu physical path. Error Code: %s",
    "VirtualApplicationDoesNotExist": "Virtual application doesn't exists : %s",
    "JSONParseError": "Unable to parse JSON file: %s. Error: %s",
    "JSONvariablesubstitutionappliedsuccessfully": "JSON variable substitution applied successfully.",
    "XMLvariablesubstitutionappliedsuccessfully": "XML variable substitution applied successfully.",
    "failedtoUploadFileToKudu": "Unable to upload file: %s to Kudu (%s). Status Code: %s",
    "failedtoUploadFileToKuduError": "Unable to upload file: %s to Kudu (%s). Error: %s",
    "ExecuteScriptOnKudu": "Executing given script on Kudu service.",
    "FailedToRunScriptOnKuduError": "Unable to run the script on Kudu Service. Error: %s",
    "FailedToRunScriptOnKudu": "Unable to run the script on Kudu: %s. Status Code: %s",
    "ScriptExecutionOnKuduSuccess": "Successfully executed script on Kudu.",
    "ScriptExecutionOnKuduFailed": "Executed script returned '%s' as return code. Error: %s",
    "FailedtoDeleteFileFromKudu": "Unable to delete file: %s from Kudu (%s). Status Code: %s",
    "FailedtoDeleteFileFromKuduError": "Unable to delete file: %s from Kudu (%s). Error: %s",
    "ScriptFileNotFound": "Script file '%s' not found.",
    "InvalidScriptFile": "Invalid script file '%s' provided. Valid extensions are .bat and .cmd for windows and .sh for linux",
    "RetryForTimeoutIssue": "Script execution failed with timeout issue. Retrying once again.",
    "stdoutFromScript": "Standard output from script: ",
    "stderrFromScript": "Standard error from script: ",
    "FailedToGetKuduFileContent": "Unable to get file content: %s . Status code: %s (%s)",
    "FailedToGetKuduFileContentError": "Unable to get file content: %s. Error: %s",
    "ScriptStatusTimeout": "Unable to fetch script status due to timeout.",
    "PollingForFileTimeOut": "Unable to fetch script status due to timeout. You can increase the timeout limit by setting 'appservicedeploy.retrytimeout' variable to number of minutes required.",
    "InvalidPollOption": "Invalid polling option provided: %s.",
    "AutoDetectDjangoSettingsFailed": "Unable to detect DJANGO_SETTINGS_MODULE 'settings.py' file path. Ensure that the 'settings.py' file exists or provide the correct path in Web.config parameter input in the following format '-DJANGO_SETTINGS_MODULE <folder_name>.settings'",
    "FailedToApplyTransformation": "Unable to apply transformation for the given package. Verify the following.",
    "FailedToApplyTransformationReason1": "1. Whether the Transformation is already applied for the MSBuild generated package during build. If yes, remove the <DependentUpon> tag for each config in the csproj file and rebuild. ",
    "FailedToApplyTransformationReason2": "2. Ensure that the config file and transformation files are present in the same folder inside the package.",
    "AutoParameterizationMessage": "ConnectionString attributes in Web.config is parameterized by default. Note that the transformation has no effect on connectionString attributes as the value is overridden during deployment by 'Parameters.xml or 'SetParameters.xml' files. You can disable the auto-parameterization by setting /p:AutoParameterizationWebConfigConnectionStrings=False during MSBuild package generation.",
    "UnsupportedAppType": "App type '%s' not supported in Web.config generation. Valid values for '-appType' are: 'python_Bottle', 'python_Django', 'python_Flask' and 'node'",
    "UnableToFetchAuthorityURL": "Unable to fetch authority URL.",
    "UnableToFetchActiveDirectory": "Unable to fetch Active Directory resource ID.",
    "SuccessfullyUpdatedRuntimeStackAndStartupCommand": "Successfully updated the Runtime Stack and Startup Command.",
    "FailedToUpdateRuntimeStackAndStartupCommand": "Failed to update the Runtime Stack and Startup Command. Error: %s.",
    "SuccessfullyUpdatedWebAppSettings": "Successfully updated the App settings.",
    "FailedToUpdateAppSettingsInConfigDetails": "Failed to update the App settings. Error: %s.",
    "UnableToGetAzureRMWebAppMetadata": "Failed to fetch AzureRM WebApp metadata. ErrorCode: %s",
    "UnableToUpdateAzureRMWebAppMetadata": "Unable to update AzureRM WebApp metadata. Error Code: %s",
    "Unabletoretrieveazureregistrycredentials": "Unable to retrieve Azure Container Registry credentials.[Status Code: '%s']",
    "UnableToReadResponseBody": "Unable to read response body. Error: %s",
    "UnableToUpdateWebAppConfigDetails": "Unable to update WebApp config details. StatusCode: '%s'",
    "AddingReleaseAnnotation": "Adding release annotation for the Application Insights resource '%s'",
    "SuccessfullyAddedReleaseAnnotation": "Successfully added release annotation to the Application Insight : %s",
    "FailedAddingReleaseAnnotation": "Failed to add release annotation. %s",
    "RenameLockedFilesEnabled": "Rename locked files enabled for App Service.",
    "FailedToEnableRenameLockedFiles": "Failed to enable rename locked files. Error: %s",
    "WebJobsInProgressIssue": "Few WebJobs in running state prevents the deployment from removing the files. You can disable 'Remove additional files at destination' option or Stop continuous Jobs before deployment.",
    "FailedToFetchKuduAppSettings": "Failed to fetch Kudu App Settings. Error: %s",
    "FailedToCreatePath": "Failed to create path '%s' from Kudu. Error: %s",
    "FailedToDeleteFile": "Failed to delete file '%s/%s' from Kudu. Error: %s",
    "FailedToDeleteFolder": "Failed to delete folder '%s' from Kudu. Error: %s",
    "FailedToUploadFile": "Failed to upload file '%s/%s' from Kudu. Error: %s",
    "FailedToGetFileContent": "Failed to get file content '%s/%s' from Kudu. Error: %s",
    "FailedToListPath": "Failed to list path '%s' from Kudu. Error: %s",
    "RetryToDeploy": "Retrying to deploy the package.",
    "FailedToGetAppServiceDetails": "Failed to fetch App Service '%s' details. Error: %s",
    "FailedToGetAppServicePublishingProfile": "Failed to fetch App Service '%s' publishing profile. Error: %s",
    "FailedToUpdateAppServiceMetadata": "Failed to update App service '%s' Meta data. Error: %s",
    "FailedToGetAppServiceMetadata": "Failed to get App service '%s' Meta data. Error: %s",
    "FailedToPatchAppServiceConfiguration": "Failed to patch App Service '%s' configuration. Error: %s",
    "FailedToUpdateAppServiceConfiguration": "Failed to update App service '%s' configuration. Error: %s",
    "FailedToGetAppServiceConfiguration": "Failed to get App service '%s' configuration. Error: %s",
    "FailedToGetAppServicePublishingCredentials": "Failed to fetch App Service '%s' publishing credentials. Error: %s",
    "FailedToGetAppServiceApplicationSettings": "Failed to get App service '%s' application settings. Error: %s",
    "FailedToUpdateAppServiceApplicationSettings": "Failed to update App service '%s' application settings. Error: %s",
    "UpdatingAppServiceConfigurationSettings": "Trying to update App Service Configuration settings. Data: %s",
    "UpdatedAppServiceConfigurationSettings": "Updated App Service Configuration settings.",
    "UpdatedAppServiceApplicationSettings": "Updated App Service Application settings and Kudu Application settings.",
    "UpdatedOnlyAppServiceApplicationSettings": "Updated App Service Application settings.",
    "MultipleResourceGroupFoundForAppService": "Multiple resource group found for App Service '%s'.",
    "PackageDeploymentUsingZipDeployFailed": "Package deployment using ZIP Deploy failed. Refer logs for more details.",
    "PackageDeploymentInitiated": "Package deployment using ZIP Deploy initiated.",
    "FailedToGetDeploymentLogs": "Failed to get deployment logs. Error: %s",
    "GoExeNameNotPresent": "Go exe name is not present",
    "Updatemachinetoenablesecuretlsprotocol": "Make sure the machine is using TLS 1.2 protocol or higher. Check https://aka.ms/enableTlsv2 for more information on how to enable TLS in your machine.",
    "CouldNotFetchAccessTokenforAzureStatusCode": "Could not fetch access token for Azure. Status code: %s, status message: %s",
    "CouldNotFetchAccessTokenforMSIDueToMSINotConfiguredProperlyStatusCode": "Could not fetch access token for Managed Service Principal. Please configure Managed Service Identity (MSI) for virtual machine 'https://aka.ms/azure-msi-docs'. Status code: %s, status message: %s",
    "CouldNotFetchAccessTokenforMSIStatusCode": "Could not fetch access token for Managed Service Principal. Status code: %s, status message: %s",
    "XmlParsingFailed": "Unable to parse publishProfileXML file, Error: %s",
    "PropertyDoesntExistPublishProfile": "[%s] Property does not exist in publish profile",
    "InvalidConnectionType": "Invalid service connection type",
    "InvalidImageSourceType": "Invalid Image source Type",
    "InvalidPublishProfile": "Publish profile file is invalid.",
    "ASE_SSLIssueRecommendation": "To use a certificate in App Service, the certificate must be signed by a trusted certificate authority. If your web app gives you certificate validation errors, you're probably using a self-signed certificate and to resolve them you need to set a variable named VSTS_ARM_REST_IGNORE_SSL_ERRORS to the value true in the build or release pipeline",
    "ZipDeployLogsURL": "Zip Deploy logs can be viewed at %s",
    "DeployLogsURL": "Deploy logs can be viewed at %s",
    "AppServiceApplicationURL": "App Service Application URL: %s",
    "ASE_WebDeploySSLIssueRecommendation": "To use a certificate in App Service, the certificate must be signed by a trusted certificate authority. If your web app gives you certificate validation errors, you're probably using a self-signed certificate and to resolve them you need to pass -allowUntrusted in additional arguments of web deploy option.",
    "FailedToGetResourceID": "Failed to get resource ID for resource type '%s' and resource name '%s'. Error: %s",
    "JarPathNotPresent": "Java jar path is not present",
    "FailedToUpdateApplicationInsightsResource": "Failed to update Application Insights '%s' Resource. Error: %s",
    "InvalidDockerImageName": "Invalid Docker hub image name provided.",
    "MsBuildPackageNotSupported": "Deployment of msBuild generated package is not supported. Change package format or use Azure App Service Deploy task.",
    "FailedToGetStorageAccountDetails": "Unable to find the storage account associated with the function app.",
    "FailedToSyncTriggers": "Failed to sync triggers for function app '%s'. Error: %s",
    "SyncingFunctionTriggers": "Syncing triggers for function app",
    "SyncFunctionTriggersSuccess": "Sync triggers for function app completed successfully",
    "UpdatedRunFromPackageSettings": "Updated WEBSITE_RUN_FROM_PACKAGE Application setting to %s",
    "DeploymentTypeNotSupportedForLinuxConsumption": "The Deployment Type option does not apply for Linux Consumption.",
    "DeploymentTypeNotSupportedForFlexConsumption": "The Deployment Type option does not apply for Flex Consumption."
  }
}